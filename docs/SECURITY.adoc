= Security Practices
:toc: left
:toclevels: 3
:icons: font

This document outlines the security practices implemented in this repository, particularly around version pinning and supply chain security.

== GitHub Actions Security

=== Pinned Actions

All GitHub Actions in this repository are pinned to specific commit SHAs for maximum security:

* *actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683* # v4.2.2
* *actions/upload-artifact@84480863f228bb9747b473957fcc9e309aa96097* # v4.4.3
* *actions/cache@v4* # Latest stable v4 (updated from deprecated SHA)
* *bazel-contrib/setup-bazel@e8776f58fb6a6e9055cbaf1b38c52ccc5247e9c4* # v0.8.1

=== Pinned Runner Images

We use specific runner versions instead of `latest` tags for supported platforms:

* *ubuntu-24.04* (instead of ubuntu-latest)
* *macos-15* (instead of macos-latest)

*Note*: Windows support has been removed to simplify the build matrix and reduce maintenance overhead. The architecture remains flexible for future Windows support if needed.

=== Script Pinning

Where possible, external scripts are pinned to specific commits:

* *Homebrew install script*: `f45fcfb55fb4da96ff39de2da4d8a1134a83e8b7`

== Dependency Management

=== Dependabot Configuration

Automatic security updates are managed via `.github/dependabot.yml`:

* *GitHub Actions*: Weekly updates every Monday at 08:00 UTC
* *Pull request limits*: 5 concurrent GitHub Actions PRs
* *Automatic labeling*: `dependencies`, `github-actions`, `automated`
* *Commit message format*: `chore(deps): description`

== Security Features

=== üîí *Supply Chain Protection*
* All GitHub Actions pinned to immutable commit SHAs
* External scripts pinned to specific versions
* Dependabot automatic security updates
* Comprehensive security documentation

=== üõ°Ô∏è *Runtime Security*
* Explicit permissions model (`contents: read`, `actions: read`, etc.)
* Isolated job environments with specific timeouts
* Input validation and error handling
* Cache versioning to prevent cache poisoning

=== üìä *Monitoring & Auditing*
* Workflow run artifact retention for investigation
* Detailed logging and structured output
* Performance benchmarks and timing analysis
* Automated test result reporting

== Unavoidable "Latest" Usage

Some components cannot be pinned due to their dynamic nature:

=== *Package Managers (Unavoidable)*
* `brew install <package>` - Homebrew packages get latest stable versions
* `apt-get install <package>` - APT packages get latest available versions

*Mitigation*: We use specific package versions where possible and maintain cache versioning to detect changes.

=== *CI Environment (Controlled)*
* Runner OS updates are controlled by using specific versions like `ubuntu-24.04`
* Tool installations are cached and verified with version checks

== Cache Security

=== *V2 Cache Architecture*
* Updated to use GitHub's new cache service (v2) for improved performance
* Cache keys include file hashes to prevent cache poisoning
* Restore keys provide fallback without compromising security
* Cache versioning allows invalidation when needed

=== *Cache Strategy*
[source,yaml]
----
key: tools-${{ os }}-${{ cache-version }}-${{ hashFiles('**/BUILD', '**/*.bzl') }}
restore-keys: |
  tools-${{ os }}-${{ cache-version }}-
  tools-${{ os }}-
----

== Supported Platforms

Currently supporting:

* *Ubuntu 24.04* - Primary Linux target
* *macOS 15* - Primary macOS target

Windows support was removed to simplify the build matrix but the architecture remains extensible for future platform additions.

== Incident Response

=== *Security Issue Reporting*
1. *DO NOT* open public issues for security vulnerabilities
2. Contact repository maintainers directly
3. Provide detailed information about the issue
4. Wait for acknowledgment before public disclosure

=== *Response Process*
1. *Assessment*: Evaluate severity and impact
2. *Containment*: Disable affected workflows if necessary
3. *Remediation*: Develop and test fixes
4. *Communication*: Notify users of any required actions
5. *Documentation*: Update security practices as needed

== Best Practices

=== *For Contributors*
* Always use pinned versions for new actions
* Update `docs/SECURITY.adoc` when adding new dependencies
* Test security changes in isolated branches
* Follow the principle of least privilege

=== *For Maintainers*
* Review Dependabot PRs promptly
* Monitor GitHub Security Advisories
* Keep security documentation up-to-date
* Regular security audits of the build process

== Compliance

This repository follows:

* *OpenSSF Scorecard* best practices
* *GitHub Security Best Practices* for Actions
* *NIST Cybersecurity Framework* principles
* *Zero Trust* security model

== Security Contacts

* *Repository Owner*: @mikekobit
* *Security Issues*: Use GitHub Security tab for private disclosure
* *General Questions*: Create issue with `security` label

== References

* link:https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions[GitHub Actions Security Hardening]
* link:https://docs.github.com/en/code-security/dependabot[Dependabot Documentation]
* link:https://slsa.dev/[Supply Chain Security Best Practices]

---

*Last Updated*: 2025-01-16 +
*Next Review*: 2025-04-16
