#!/usr/bin/env python3

import argparse
import json
from generate_claude_hook_lib import VALID_HOOK_EVENTS, generate_hook_config

def main():
    """
    Parses command-line arguments and prints the generated hook configuration.
    """
    parser = argparse.ArgumentParser(
        description="Generate a Claude Code hook configuration.",
        formatter_class=argparse.RawTextHelpFormatter,
        epilog="""
Example usage:
  generate-claude-hook --event PreToolUse --matcher "Bash" --command "echo 'Hello from hook'"
  generate-claude-hook --event PostToolUse --matcher "Edit|Write" --command "npx prettier --write \\$FILE_PATH"

The --matcher argument accepts:
  - A single tool name (e.g., "Bash")
  - A pipe-separated list of tool names (e.g., "Edit|Write")
  - A wildcard "*" to match all tools
"""
    )

    parser.add_argument(
        "--event",
        required=True,
        choices=VALID_HOOK_EVENTS,
        help="The hook event type.",
    )
    parser.add_argument(
        "--matcher",
        required=True,
        help="The tool matcher string.",
    )
    parser.add_argument(
        "--command",
        required=True,
        help="The shell command to execute for the hook.",
    )

    args = parser.parse_args()

    config_dict = generate_hook_config(
        event=args.event,
        matcher_str=args.matcher,
        command=args.command
    )

    print(json.dumps(config_dict, indent=2))

if __name__ == "__main__":
    main()
