#!/bin/sh
tempfile="$(mktemp)"
trap 'rm -rf "${tempfile}"' EXIT
cat > "${tempfile}"

# Add our managed section if not present
if ! grep -q "# {{ .chezmoi.sourceFile }}:BEGIN:chezmoi:zsh" "${tempfile}"; then
  cat >> "${tempfile}" << 'EOF'

# {{ .chezmoi.sourceFile }}:BEGIN:chezmoi:zsh
# Generated by chezmoi modify script - Host: {{ .chezmoi.hostname }} User: {{ .chezmoi.username }}
# WARNING: Do not edit this section manually - managed by chezmoi
source {{ .chezmoi.homeDir }}/.dotfiles/zsh/config.zsh
# {{ .chezmoi.sourceFile }}:END:chezmoi:zsh
EOF
fi

cat "${tempfile}"