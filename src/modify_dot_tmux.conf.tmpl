#!/bin/sh
tempfile="$(mktemp)"
trap 'rm -rf "${tempfile}"' EXIT
cat > "${tempfile}"

# Add our managed section if not present
if ! grep -q "# {{ .chezmoi.sourceFile }}:BEGIN:chezmoi:tmux" "${tempfile}"; then
  cat >> "${tempfile}" << 'EOF'

# {{ .chezmoi.sourceFile }}:BEGIN:chezmoi:tmux
# Generated by chezmoi modify script - Host: {{ .chezmoi.hostname }} User: {{ .chezmoi.username }}
# WARNING: Do not edit this section manually - managed by chezmoi
source-file {{ .chezmoi.homeDir }}/.config/tmux/config.tmux
# {{ .chezmoi.sourceFile }}:END:chezmoi:tmux
EOF
fi

cat "${tempfile}"