#!/bin/sh
tempfile="$(mktemp)"
trap 'rm -rf "${tempfile}"' EXIT
cat > "${tempfile}"

# Add our managed section if not present
if ! grep -q "# chezmoi dotfiles managed configuration - START" "${tempfile}"; then
  cat >> "${tempfile}" << 'EOF'

# ============================================================================
# chezmoi dotfiles managed configuration - START
# Generated by: {{ .chezmoi.sourceDir }}/modify_dot_gitconfig.tmpl
# Host: {{ .chezmoi.hostname }}
# User: {{ .chezmoi.username }}
# WARNING: Do not edit this section manually - managed by chezmoi
# ============================================================================
[include]
  path = {{ .chezmoi.homeDir }}/.config/git/config
# ============================================================================
# chezmoi dotfiles managed configuration - END
# ============================================================================
EOF
fi

cat "${tempfile}"