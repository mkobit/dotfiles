{{ if and .hammerspoon.enabled (eq .hammerspoon.installation "package-manager") }}#!/bin/bash

# logging.sh hash: {{ include "scripts/logging.sh" | sha256sum }}
source "${CHEZMOI_SOURCE_DIR:?}/scripts/logging.sh"

# Check if hammerspoon is already installed
if check_command brew && brew list --cask hammerspoon &>/dev/null; then
    log_success "hammerspoon already installed"
else
    log_info "Installing hammerspoon via package manager..."

{{ if eq .chezmoi.os "darwin" }}
    # macOS - use Homebrew Cask
    if ! check_command brew; then
        log_error "Homebrew not found. Please install Homebrew first."
        exit 1
    fi

    if brew install --cask hammerspoon; then
        log_success "hammerspoon installed successfully via homebrew cask"
    else
        log_error "Failed to install hammerspoon via homebrew cask"
        exit 1
    fi
{{ else }}
    log_error "Unsupported OS: {{ .chezmoi.os }}"
    log_info "Hammerspoon is only available on macOS"
    exit 1
{{ end }}
fi

# Configure custom config directory
log_info "Configuring Hammerspoon to use {{ .chezmoi.destDir }}/.dotfiles/hammerspoon/init.lua"
defaults write org.hammerspoon.Hammerspoon MJConfigFile "{{ .chezmoi.destDir }}/.dotfiles/hammerspoon/init.lua"
log_success "Hammerspoon configuration path set"
{{ end }}
